@use "mixins/flexbox" as *;

.garages-container {
  overflow-x: auto;
  overflow-y: hidden;
  width: 100vw;
  height: 100vh;
  padding: 0;

  scroll-behavior: smooth;
  scroll-snap-type: x mandatory;
}

.garages {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  width: auto;
  height: 100vh;
  padding: 0;

  $c4: var(--color4);

  .garage {
    flex-shrink: 0;
    width: 100vw;
    min-width: 100vw;
    height: 100vh;
    margin: 0;
    padding: var(--spacing-vh-lg) var(--spacing-vw-md);
    box-sizing: border-box;

    scroll-snap-align: start;

    border: 1px solid var(--border-light);
    border-radius: 0;
    background-color: var(--bg-glass);

    backdrop-filter: var(--blur-light);
  }

  .garage-strokes {
    display: grid;
    grid-template-columns: repeat(var(--grid-columns-desktop), 1fr);
    gap: var(--grid-gap);
    margin: var(--spacing-md) 0;
    width: 100%;
    height: calc(100vh - 8vh - 140px);

    border-radius: var(--radius-md);
  }

  //===== Input Text
  .garage-strokes .garage-stroke-box {
    display: flex;
    flex-direction: column;
    width: 100%;
    max-width: 100%;
    height: 100%;
    margin: 0;
    padding: var(--spacing-vh-sm) var(--spacing-vw-sm);
    box-sizing: border-box;

    border: 1px solid var(--border-strong);
    border-radius: var(--radius-sm);
    background: var(--bg-overlay-normal);
  }

  .garage-strokes {
    // Delete Button
    .clear-area {
      margin: 8px 0;

      @include flex(end, center);
    }
    input[type="button"] {
      color: currentcolor;
      border-color: currentcolor;
      background: #0005;
    }
    .garage-stroke-box:nth-child(1) {
      h3,
      textarea,
      input[type="button"] {
        color: $c4;
        // border-color: $c4;
      }
      textarea {
        &::-webkit-scrollbar-thumb {
          background: rgba(102, 217, 239, 0.5); // $c4 #66d9ef
        }
        scrollbar-color: rgba(102, 217, 239, 0.5) transparent;
      }
    }
    .garage-stroke-box:nth-child(2) {
      h3,
      textarea,
      input[type="button"] {
        color: var(--color2);
        border-color: var(--color2);
      }
      textarea {
        &::-webkit-scrollbar-thumb {
          background: rgba(166, 226, 46, 0.5); // var(--color2) #a6e22e
        }
        scrollbar-color: rgba(166, 226, 46, 0.5) transparent;
      }
    }
    .garage-stroke-box:nth-child(3) {
      h3,
      textarea,
      input[type="button"] {
        color: var(--color3);
        border-color: var(--color3);
      }
      textarea {
        &::-webkit-scrollbar-thumb {
          background: rgba(253, 151, 31, 0.5); // var(--color3) #fd971f
        }
        scrollbar-color: rgba(253, 151, 31, 0.5) transparent;
      }
    }
    .garage-stroke-box:nth-child(4) {
      h3,
      textarea,
      input[type="button"] {
        color: var(--color1);
        border-color: var(--color1);
      }
      textarea {
        &::-webkit-scrollbar-thumb {
          background: rgba(249, 38, 114, 0.5); // var(--color1) #f92672
        }
        scrollbar-color: rgba(249, 38, 114, 0.5) transparent;
      }
    }
  }

  //===== input area
  textarea {
    flex: 1;
    overflow: auto;
    width: 100%;
    max-width: 100%;
    margin: auto;
    padding: 0.5ch 1ch;
    box-sizing: border-box;

    resize: none;
    transition: 0.15s;

    border: 2px solid currentcolor !important;
    border-radius: 8px;
    background-color: rgba(#000, 0.35);
    // background-color:rgba(currentColor, .4);

    font-family: YakuHanRP, "M PLUS Rounded 1c", "Hiragino Sans",
      "Hiragino Kaku Gothic ProN", "Noto Sans JP", Meiryo, sans-serif;
    font-size: 0.9em;
    // filter:drop-shadow(1px 2px 1px currentColor);

    filter: drop-shadow(1px 1px 0px black);
    touch-action: manipulation;
    @include flex(center);
    &:hover {
      border-color: white !important;
      // box-shadow: 0 0 2px #ccc;
      background-color: rgba(#000, 0.2);
    }
    &:focus,
    &:focus-visible {
      border: 2px solid currentcolor !important;
      background-color: rgba(#000, 0.5);
      // box-shadow: 0 0 4px #ccc;
    }
  }
}
// ===== Mobile Responsive
@media only screen and (max-width: 1024px) {
  .garages-container {
    padding: 12px 12px 24px;
  }

  .garage-strokes {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 12px;
    width: 100%;
  }

  .garage-strokes .garage-stroke-box {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100%;
    height: auto !important;
    min-height: 400px;
    padding: 12px;
    box-sizing: border-box;
  }
}

// Mobile: Keep horizontal scroll like PC
// モバイルでもPC同様に横スクロールを維持
@media only screen and (max-width: 768px) {
  .garages-container {
    // Keep horizontal scroll
    overflow-x: auto;
    overflow-y: auto; // Allow vertical scrolling on mobile
    padding: 12px 0 80px;
    width: 100vw;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    // Use proximity for smoother mobile scroll (not mandatory)
    scroll-snap-type: x proximity;
    -webkit-overflow-scrolling: touch; // Smooth scrolling on iOS
  }

  .garages {
    // Keep horizontal layout (do NOT use flex-direction: column)
    flex-direction: row;
    width: auto;
    height: auto;
    padding: 0;
  }

  .garage {
    // Each garage takes full viewport width
    flex-shrink: 0;
    width: 100vw !important;
    min-width: 100vw !important;
    max-width: 100vw !important;
    height: auto !important;
    min-height: 100vh !important;
    padding: 16px !important; // Use fixed px, not vw
    margin: 0 !important;
    box-sizing: border-box !important; // Include padding in width
    border: none !important; // Remove borders to prevent width issues
    overflow-x: hidden !important; // Prevent internal horizontal overflow
    overflow-y: auto !important; // Allow vertical scroll within garage
  }

  .garage-strokes {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important; // 2x2 grid: Key/Issue on top, Action/Publish below
    grid-template-rows: 1fr 1fr !important;
    gap: 10px !important;
    height: auto !important;
    min-height: auto !important;
    margin: 12px 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    overflow: visible !important;
  }

  .garage-strokes .garage-stroke-box {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    max-width: 100%;
    height: auto !important;
    min-height: 200px;
    margin: 0 !important;
    padding: 10px !important;
    border-radius: 6px !important;
    box-sizing: border-box !important;
    overflow: hidden;
  }

  textarea {
    flex: 1 !important;
    font-size: 1rem !important;
    width: 100% !important;
    max-width: 100%;
    padding: 8px !important;
    box-sizing: border-box !important;
    overflow-y: auto;
  }

  // Title input
  input[type="text"].title-input {
    font-size: 1rem !important;
    padding: 8px !important;
  }

  h3 {
    font-size: 0.9rem !important;
    margin-bottom: 6px !important;
  }

  .garage-head {
    margin: 0 16px 12px;
    gap: 8px;
  }
}

@media only screen and (max-width: 480px) {
  .garages-container {
    padding: 0px 0 64px;
    // More relaxed snap on small screens
    scroll-snap-type: none;
  }

  .garage {
    padding: 12px 8px !important;
  }

  .garage-strokes {
    grid-template-columns: 1fr !important; // Single column on very small screens
    gap: 10px !important;
  }

  .garage-strokes .garage-stroke-box {
    min-height: 200px;
    padding: 10px !important;
  }

  textarea {
    font-size: 1rem !important;
    padding: 8px 10px !important;
    min-height: 20vh !important;
  }

  input[type="button"] {
    font-size: 0.85rem !important;
    padding: 6px 12px !important;
  }
}
